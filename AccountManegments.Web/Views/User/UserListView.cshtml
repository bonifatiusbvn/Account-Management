@inject IHttpContextAccessor Accessor;
@inject UserSession _userSession
@{
    ViewData["Title"] = "UserListView";
    Layout = "~/Views/Shared/Main_Layout.cshtml";
}
<style>
    .fixed-button {
        position: fixed;
        top: 80px;
        right: 20px;
        z-index: 1000;
    }
</style>
<div class="page-breadcrumb d-none d-sm-flex align-items-center mb-3">
    <div class="d-flex align-items-center">
        <form class="position-relative">
            @if (UserSession.FormPermisionData.Any(a => a.FormName == "User List" && (a.Add == true)))
            {
                <button type="button" class="btn btn-primary fixed-button" onclick="ClearUserTextBox()"><i class="lni lni-circle-plus"></i>User</button>
            }
        </form>
    </div>
</div>
<div class="">
    <div class="">
        <div class=" radius-10 w-100">
            <div class="my-3 border-bottom"></div>
            <div class="">
                <div class="row">
                    <div class="col-12 col-lg-7 col-md-7 col-xl-7">
                        <div class="card radius-10 w-100">
                            <div class="card-body">


                                <div class="row w-100 ac-view-list card radius-10 w-100">

                                    <div class="row ">
                                        <div class="col-12">
                                            <div class="card-body">
                                                <div class="row g-3">

                                                    <div class="col-12 col-lg-4">
                                                        <input class="form-control" id="txtSearch" onkeyup="filterTable()" placeholder="Search">
                                                        </input>
                                                    </div>
                                                    <div class="col-12 col-lg-4">
                                                        <select class="form-select" id="ddlSearchBy" onchange="filterTable()">
                                                            <option selected="selected">All</option>
                                                            <option>UserName</option>
                                                        </select>
                                                    </div>

                                                    <div class="col-12 col-lg-4">
                                                        <select class="form-select" id="ddlSortBy" onchange="sortTable()">
                                                            <option value="DescendingCreatedOn" selected="selected">Most Recent</option>
                                                            <option value="AscendingCreatedOn">First Created</option>
                                                            <option value="AscendingUserName">UserName(a-z)</option>
                                                            <option value="DescendingUserName">UserName(z-a)</option>
                                                            <option value="AscendingFirstName">Name-Asc </option>
                                                            <option value="DescendingFirstName">Name-Asc</option>
                                                        </select>
                                                    </div>
                                                </div><!--end row-->

                                            </div>

                                        </div>

                                    </div>


                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table align-middle mb-0">
                                                <thead class="table-light">
                                                    <tr>
                                                        <th>Full Name</th>
                                                        <th>User Name</th>
                                                        <th>Active</th>
                                                        @if (UserSession.FormPermisionData.Any(a => a.FormName == "User List" && (a.Edit == true || a.Delete == true)))
                                                        {
                                                            <th>Action</th>
                                                        }
                                                    </tr>
                                                </thead>
                                                <tbody id="Usertbody">
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>


                                </div>

                            </div>
                        </div>
                        <!--end row-->


                    </div>
                    <div class="col-12 col-lg-5 col-xl-5 ac-detail hide-sm">
                        <div class="card radius-10">
                            <div class="card-body" style="height:650px">
                                <h5 class="mb-0 mt-4">User Information</h5>
                                <hr>
                                <div class="row g-3 ac-detail d-none">
                                    <div class="col-6">
                                        <label class="form-label">First Name</label>
                                        <input type="text" class="form-control" id="dspFirstName" readonly>
                                        <input type="hidden" class="form-control" id="dspUserid" readonly>
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">Last Name</label>
                                        <input type="text" class="form-control" id="dspLastName" readonly>
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">Username</label>
                                        <input type="text" class="form-control" id="dspUserName" readonly>
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">Site</label>
                                        <input type="text" class="form-control" id="dspSiteName" readonly>
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">Password</label>
                                        <input type="text" class="form-control" id="dspPassword" readonly>
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">Email</label>
                                        <input type="text" class="form-control" id="dspEmail" readonly>
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">Phone</label>
                                        <input type="text" class="form-control" id="dspPhoneNo" readonly>
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">Role</label>
                                        <input type="text" class="form-control" id="dspRole" readonly>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="offcanvas offcanvas-end border-0 w-25 ac-add-edit" tabindex="-1" id="createUser">
            <div class="d-flex align-items-center bg-primary bg-gradient p-3 offcanvas-header">
                <h5 class="m-0 me-2 text-white">Create User</h5>
                <button type="button" class="btn-close btn-close-white ms-auto" id="customizerclose-btn" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body p-0">
                <div data-simplebar class="h-100">
                    <div class="p-4">
                        <div class="card">
                            <div class="card-body">
                                <form class="row g-3" id="userForm">
                                    <div class="col-12">
                                        <label class="form-label">First Name</label>
                                        <input type="text" class="form-control" placeholder="First Name" id="txtFirstName" name="txtFirstName" >
                                        <input type="hidden" id="txtUserid">
                                        <input type="hidden" id="txtUserRole" value="@_userSession.UserRole">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Last Name</label>
                                        <input type="text" class="form-control" placeholder="Last Name" id="txtLastName" name="txtLastName">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">User Name</label>
                                        <input type="text" class="form-control" placeholder="User Name" id="txtUserName" name="txtUserName">
                                    </div>
                                    @if (_userSession.UserRole == 3)
                                    {
                                        <div class="col-12">
                                            <label class="form-label">Site</label>
                                            <select class="form-select" id="ddlSiteName" name="ddlSiteName">
                                                <option selected value="">All Site</option>
                                            </select>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="col-12">
                                            <label class="form-label">Site</label>
                                            <select class="form-select" id="ddlSiteName" name="ddlSiteName" disabled>
                                                <option selected value="@UserSession.SiteId">@UserSession.SiteName</option>
                                            </select>
                                        </div>
                                    }
                                    <div class="col-12">
                                        <label class="form-label">Role</label>
                                        <select class="form-select" id="ddlUserRole" name="ddlUserRole">
                                            <option value="">--Select--</option>
                                        </select>
                                        <input type="hidden" id="txtrole">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Password</label>
                                        <div class="input-group">
                                            <input type="password" class="form-control" placeholder="Password" id="txtPassword" name="txtPassword">
                                            <span class="input-group-text">
                                                <button class="btn btn-link" type="button" id="passwordToggle" style="height:21px;width:21px; display: flex; justify-content: center; align-items: center;">
                                                    <div id="openEye">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-eye"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                                                    </div>
                                                    <div class="d-none" id="closeEye">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-eye-off"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>
                                                    </div>
                                                </button>
                                            </span>
                                        </div>
                                    </div>

                                    <div class="col-12">
                                        <label class="form-label">Email</label>
                                        <input type="text" class="form-control" placeholder="Email" id="txtEmail" name="txtEmail">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Phone Number</label>
                                        <input type="text" class="form-control" placeholder="Phone Number" id="txtPhoneNo" name="txtPhoneNo">
                                    </div>
                                    <div class="col-12">
                                        <button type="button" class="btn btn-lg btn-success col-lg-12" onclick="validateAndCreateUser()" id="btnuser"></button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<style>
    #txtFirstName-error, #txtLastName-error, #txtUserName-error, #txtPassword-error,
    #txtEmail-error, #txtPhoneNo-error, #ddlUserRole-error, #ddlSiteName-error {
        color: red;
    }

    label.failed {
        color: red;
    }
</style>
@section Scripts {

    <script src="~/moduls/authenticationscript.js" asp-append-version="true"></script>
    <script src="~/moduls/masterlistscript.js" asp-append-version="true"></script>
}
<script src="~/assets/js/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        $('#passwordToggle').click(function () {

            var passwordInput = $('#txtPassword');
            var openIcon = $('#openEye');
            var closeIcon = $('#closeEye');

            if (passwordInput.attr('type') === 'password') {
                passwordInput.attr('type', 'text');
                openIcon.addClass('d-none');
                closeIcon.removeClass('d-none');
            }
            else {

                passwordInput.attr('type', 'password');
                openIcon.removeClass('d-none');
                closeIcon.addClass('d-none');
            }
        });
    });
</script>